-- Find total customers by countries
SELECT
	l.country,
	COUNT(o.customer_key) AS total_customer
FROM fact_orders AS o
LEFT JOIN dim_location AS l
	ON l.location_key = o.location_key
GROUP BY l.country
ORDER BY total_customer DESC;

-- Find total customers by regions
SELECT
	l.region,
	COUNT(o.customer_key) AS total_customer
FROM fact_orders AS o
LEFT JOIN dim_location AS l
	ON l.location_key = o.location_key
GROUP BY l.region
ORDER BY total_customer DESC;

-- Find total products by categories
SELECT
	category,
	COUNT(product_key) AS total_product
FROM dim_products
GROUP BY category
ORDER BY total_product DESC;

-- What is the total revenue generated for each category?
SELECT
	p.category,
	SUM(o.sales) AS total_revenue
FROM fact_orders AS o
LEFT JOIN dim_products AS p
	ON p.product_key = o.product_key
GROUP BY p.category
ORDER BY total_revenue DESC;

-- What is the total revenue generated by each custmer?
SELECT
	c.customer_name,
	SUM(o.sales) AS total_revenue
FROM fact_orders AS o
LEFT JOIN dim_customers AS c
	ON c.customer_key = o.customer_key
GROUP BY c.customer_name
ORDER BY total_revenue DESC;

-- What is the distribution of sold items across regions?
SELECT
	l.region,
	SUM(o.quantity) AS total_quantity
FROM fact_orders AS o
LEFT JOIN dim_location AS l
	ON l.location_key = o.location_key
GROUP BY l.region
ORDER BY total_quantity DESC;